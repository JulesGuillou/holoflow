<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BatchedSPSCQueue API Documentation &mdash; Holoflow 0.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=01f34227"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Introduction" href="introduction.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Holoflow
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">batched_spsc_queue library</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">BatchedSPSCQueue API Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N2dh16BatchedSPSCQueueE"><code class="docutils literal notranslate"><span class="pre">BatchedSPSCQueue</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N2dh16BatchedSPSCQueue16BatchedSPSCQueueE6size_t6size_t6size_t6size_tNSt4spanI7uint8_tEE"><code class="docutils literal notranslate"><span class="pre">BatchedSPSCQueue::BatchedSPSCQueue()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N2dh16BatchedSPSCQueue9write_ptrEv"><code class="docutils literal notranslate"><span class="pre">BatchedSPSCQueue::write_ptr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N2dh16BatchedSPSCQueue12commit_writeEv"><code class="docutils literal notranslate"><span class="pre">BatchedSPSCQueue::commit_write()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N2dh16BatchedSPSCQueue8read_ptrEv"><code class="docutils literal notranslate"><span class="pre">BatchedSPSCQueue::read_ptr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N2dh16BatchedSPSCQueue11commit_readEv"><code class="docutils literal notranslate"><span class="pre">BatchedSPSCQueue::commit_read()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N2dh16BatchedSPSCQueue4sizeEv"><code class="docutils literal notranslate"><span class="pre">BatchedSPSCQueue::size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N2dh16BatchedSPSCQueue5resetEv"><code class="docutils literal notranslate"><span class="pre">BatchedSPSCQueue::reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N2dh16BatchedSPSCQueue4fillEv"><code class="docutils literal notranslate"><span class="pre">BatchedSPSCQueue::fill()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Holoflow</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">batched_spsc_queue library</a></li>
      <li class="breadcrumb-item active">BatchedSPSCQueue API Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/batched_spsc_queue/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="batchedspscqueue-api-documentation">
<h1>BatchedSPSCQueue API Documentation<a class="headerlink" href="#batchedspscqueue-api-documentation" title="Link to this heading"></a></h1>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N2dh16BatchedSPSCQueueE">
<span id="_CPPv3N2dh16BatchedSPSCQueueE"></span><span id="_CPPv2N2dh16BatchedSPSCQueueE"></span><span id="dh::BatchedSPSCQueue"></span><span class="target" id="classdh_1_1BatchedSPSCQueue"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BatchedSPSCQueue</span></span></span><a class="headerlink" href="#_CPPv4N2dh16BatchedSPSCQueueE" title="Link to this definition"></a><br /></dt>
<dd><p>A batched single-producer single-consumer (SPSC) queue implemented using a circular buffer. </p>
<p>This class provides a high-performance queue that allows batching of enqueue and dequeue operations. It is designed for scenarios where a single producer thread enqueues data and a single consumer thread dequeues data. The queue uses a pre-allocated memory buffer to store elements, and it supports batched operations to improve performance. Sequential elements in a batch are guaranteed to be sequential in memory.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Not meeting the specified conditions results in undefined behavior. This includes:<ul class="simple">
<li><p>Using the queue with multiple threads for enqueuing.</p></li>
<li><p>Using the queue with multiple threads for dequeuing.</p></li>
<li><p>Writing more than enqueue_batch_size elements in a single batch.</p></li>
<li><p>Writing less than dequeue_batch_size elements in a single batch.</p></li>
<li><p>Reading more than dequeue_batch_size elements in a single batch.</p></li>
<li><p>Reading less than enqueue_batch_size elements in a single batch. </p></li>
</ul>
</p>
</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N2dh16BatchedSPSCQueue16BatchedSPSCQueueE6size_t6size_t6size_t6size_tNSt4spanI7uint8_tEE">
<span id="_CPPv3N2dh16BatchedSPSCQueue16BatchedSPSCQueueE6size_t6size_t6size_t6size_tNSt4spanI7uint8_tEE"></span><span id="_CPPv2N2dh16BatchedSPSCQueue16BatchedSPSCQueueE6size_t6size_t6size_t6size_tNSt4spanI7uint8_tEE"></span><span id="dh::BatchedSPSCQueue::BatchedSPSCQueue__s.s.s.s.std::span:uint8_t:"></span><span class="target" id="classdh_1_1BatchedSPSCQueue_1a04fedc49c23d1a2d5f2c35453bf301fa"></span><span class="sig-name descname"><span class="n"><span class="pre">BatchedSPSCQueue</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nb_slots</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">enqueue_batch_size</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dequeue_batch_size</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">element_size</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">buffer</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N2dh16BatchedSPSCQueue16BatchedSPSCQueueE6size_t6size_t6size_t6size_tNSt4spanI7uint8_tEE" title="Link to this definition"></a><br /></dt>
<dd><p>Constructs a <a class="reference internal" href="#classdh_1_1BatchedSPSCQueue"><span class="std std-ref">BatchedSPSCQueue</span></a> with the specified parameters. </p>
<p><ul class="simple">
<li><p>buffer not being large enough to contain nb_slots * element_size </p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Not meeting the specified conditions results in undefined behavior. This includes:<ul class="simple">
<li><p>nb_slots not being a multiple of enqueue_batch_size or dequeue_batch_size.</p></li>
</ul>
</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nb_slots</strong> – The number of slots in the circular buffer. Note that not all slots can be used simultaneously. The actual capacity of the queue is nb_slots - enqueue_batch_size to avoid ambiguity between full and empty states. Additionally, nb_slots must be a multiple of both enqueue_batch_size and dequeue_batch_size. </p></li>
<li><p><strong>enqueue_batch_size</strong> – The number of elements that can be enqueued in a single batch. </p></li>
<li><p><strong>dequeue_batch_size</strong> – The number of elements that can be dequeued in a single batch. </p></li>
<li><p><strong>element_size</strong> – The size of each element in bytes. </p></li>
<li><p><strong>buffer</strong> – A pre-allocated memory block that is large enough to contain nb_slots * element_size bytes.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N2dh16BatchedSPSCQueue9write_ptrEv">
<span id="_CPPv3N2dh16BatchedSPSCQueue9write_ptrEv"></span><span id="_CPPv2N2dh16BatchedSPSCQueue9write_ptrEv"></span><span id="dh::BatchedSPSCQueue::write_ptr"></span><span class="target" id="classdh_1_1BatchedSPSCQueue_1a650f4f0053944ec43c1187d72fb8a047"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">write_ptr</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N2dh16BatchedSPSCQueue9write_ptrEv" title="Link to this definition"></a><br /></dt>
<dd><p>Returns a span containing the buffer where the user can write data. </p>
<p>This method provides a span where the next element(s) can be written. The caller is responsible for ensuring that the write does not exceed the available space. If the queue is full, this method returns std::nullopt.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The span returned by this method is invalidated after calling <a class="reference internal" href="#classdh_1_1BatchedSPSCQueue_1ac7e5ce74054e189e6c77d89ad0c1c3e5"><span class="std std-ref">commit_write()</span></a>. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A span containing the buffer where the user can write data, or std::nullopt if the queue is full.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N2dh16BatchedSPSCQueue12commit_writeEv">
<span id="_CPPv3N2dh16BatchedSPSCQueue12commit_writeEv"></span><span id="_CPPv2N2dh16BatchedSPSCQueue12commit_writeEv"></span><span id="dh::BatchedSPSCQueue::commit_write"></span><span class="target" id="classdh_1_1BatchedSPSCQueue_1ac7e5ce74054e189e6c77d89ad0c1c3e5"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">commit_write</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N2dh16BatchedSPSCQueue12commit_writeEv" title="Link to this definition"></a><br /></dt>
<dd><p>Commits the write operation. </p>
<p>This method updates the write index after writing data to the buffer. It should be called after writing data to the span returned by <a class="reference internal" href="#classdh_1_1BatchedSPSCQueue_1a650f4f0053944ec43c1187d72fb8a047"><span class="std std-ref">write_ptr()</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The span returned by <a class="reference internal" href="#classdh_1_1BatchedSPSCQueue_1a650f4f0053944ec43c1187d72fb8a047"><span class="std std-ref">write_ptr()</span></a> is invalidated after calling this method. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N2dh16BatchedSPSCQueue8read_ptrEv">
<span id="_CPPv3N2dh16BatchedSPSCQueue8read_ptrEv"></span><span id="_CPPv2N2dh16BatchedSPSCQueue8read_ptrEv"></span><span id="dh::BatchedSPSCQueue::read_ptr"></span><span class="target" id="classdh_1_1BatchedSPSCQueue_1a06e010d1b59df7279026f4b8dba4de7f"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">uint8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">read_ptr</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N2dh16BatchedSPSCQueue8read_ptrEv" title="Link to this definition"></a><br /></dt>
<dd><p>Returns a span containing the buffer where the user can read data. </p>
<p>This method provides a span where the next element(s) can be read. The caller is responsible for ensuring that the read does not exceed the available space. If the queue is empty, this method returns std::nullopt.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The span returned by this method is invalidated after calling <a class="reference internal" href="#classdh_1_1BatchedSPSCQueue_1ad0f41216d8959ce2f0d25a5b0eb70167"><span class="std std-ref">commit_read()</span></a>. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A span containing the buffer where the user can read data, or std::nullopt if the queue is empty.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N2dh16BatchedSPSCQueue11commit_readEv">
<span id="_CPPv3N2dh16BatchedSPSCQueue11commit_readEv"></span><span id="_CPPv2N2dh16BatchedSPSCQueue11commit_readEv"></span><span id="dh::BatchedSPSCQueue::commit_read"></span><span class="target" id="classdh_1_1BatchedSPSCQueue_1ad0f41216d8959ce2f0d25a5b0eb70167"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">commit_read</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N2dh16BatchedSPSCQueue11commit_readEv" title="Link to this definition"></a><br /></dt>
<dd><p>Commits the read operation. </p>
<p>This method updates the read index after reading data from the buffer. It should be called after reading data from the span returned by <a class="reference internal" href="#classdh_1_1BatchedSPSCQueue_1a06e010d1b59df7279026f4b8dba4de7f"><span class="std std-ref">read_ptr()</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The span returned by <a class="reference internal" href="#classdh_1_1BatchedSPSCQueue_1a06e010d1b59df7279026f4b8dba4de7f"><span class="std std-ref">read_ptr()</span></a> is invalidated after calling this method. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N2dh16BatchedSPSCQueue4sizeEv">
<span id="_CPPv3N2dh16BatchedSPSCQueue4sizeEv"></span><span id="_CPPv2N2dh16BatchedSPSCQueue4sizeEv"></span><span id="dh::BatchedSPSCQueue::size"></span><span class="target" id="classdh_1_1BatchedSPSCQueue_1a7290364811cae0734b8507ed02da1c82"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N2dh16BatchedSPSCQueue4sizeEv" title="Link to this definition"></a><br /></dt>
<dd><p>Returns the number of elements currently in the queue. </p>
<p>This method provides the current size of the queue, i.e., the number of elements that have been enqueued but not yet dequeued.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of elements currently in the queue. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N2dh16BatchedSPSCQueue5resetEv">
<span id="_CPPv3N2dh16BatchedSPSCQueue5resetEv"></span><span id="_CPPv2N2dh16BatchedSPSCQueue5resetEv"></span><span id="dh::BatchedSPSCQueue::reset"></span><span class="target" id="classdh_1_1BatchedSPSCQueue_1a7e5edb0da3c0bfc36535cda864b96402"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reset</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N2dh16BatchedSPSCQueue5resetEv" title="Link to this definition"></a><br /></dt>
<dd><p>Resets the queue. </p>
<p>This method clears the queue and resets the read and write indices. It is not thread-safe and should only be used for testing or benchmarking purposes. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N2dh16BatchedSPSCQueue4fillEv">
<span id="_CPPv3N2dh16BatchedSPSCQueue4fillEv"></span><span id="_CPPv2N2dh16BatchedSPSCQueue4fillEv"></span><span id="dh::BatchedSPSCQueue::fill"></span><span class="target" id="classdh_1_1BatchedSPSCQueue_1a46aebb7a9cdeea74e5f10a2d9d3c9e46"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fill</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N2dh16BatchedSPSCQueue4fillEv" title="Link to this definition"></a><br /></dt>
<dd><p>Fills the queue with uninitialized data. </p>
<p>This method fills the queue with uninitialized data. It is not thread-safe and should only be used for testing or benchmarking purposes. </p>
</dd></dl>

</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="introduction.html" class="btn btn-neutral float-left" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Jules Guillou.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>